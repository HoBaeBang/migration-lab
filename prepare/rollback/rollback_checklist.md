# 롤백 실행 체크리스트

## 사전 준비 단계
### 상황 파악
- [ ] 마이그레이션 실패 원인 명확히 파악
- [ ] 실패 발생 시점 정확히 기록
- [ ] 현재 시스템 상태 자세히 점검
- [ ] 데이터 손실 범위 정확히 확인
- [ ] 사용자 영향도 평가 완료

### 팀 준비
- [ ] 긴급 대응팀 모든 구성원 소집
- [ ] 담당자별 명확한 역할 분배
- [ ] 커뮤니케이션 채널 활성화 (슬랙, 전화 등)
- [ ] 모니터링 대시보드 준비 및 확인
- [ ] 에스컬레이션 절차 숙지

### 기술적 준비
- [ ] IDC 환경 상태 전면 확인
- [ ] 백업 파일 무결성 검증 완료
- [ ] 네트워크 연결 상태 점검
- [ ] 롤백 스크립트 실행 권한 확인
- [ ] 로그 파일 공간 확보
- [ ] 롤백 테스트 결과 검토

## 긴급 롤백 단계 (0-15분)
### AWS 연결 차단
- [ ] 애플리케이션에서 새로운 RDS 연결 즉시 차단
- [ ] 진행 중인 트랜잭션 완료 대기
- [ ] AWS RDS 읽기 전용 모드 설정 (가능시)
- [ ] 보안 그룹 규칙 수정 (필요시)

### IDC 재활성화
- [ ] IDC MySQL 서비스 상태 점검
- [ ] MySQL 컨테이너 재시작 (필요시)
- [ ] 데이터베이스 연결 가능 여부 테스트
- [ ] 빠른 데이터 정합성 확인 (샘플)
- [ ] 로그 에러 메시지 확인

### 서비스 전환
- [ ] 애플리케이션 설정을 IDC로 변경
- [ ] 로드밸런서 트래픽 IDC로 전환
- [ ] DNS 설정 변경 (필요시)
- [ ] 웹 서비스 접근 가능성 확인
- [ ] 헬스체크 엔드포인트 정상 동작 확인

## 전체 롤백 단계 (15-60분)
### 환경 복구
- [ ] 모든 컨테이너 완전 재시작
- [ ] 네트워크 설정 원복
- [ ] 서비스 설정 완전 원복
- [ ] 시스템 리소스 사용률 확인
- [ ] 디스크 공간 충분 여부 확인

### 데이터 복구
- [ ] 백업 파일 준비 및 검증
- [ ] 스키마 구조 복구 실행
- [ ] 테이블 데이터 복구 실행
- [ ] 외래키 제약 조건 재설정
- [ ] 인덱스 재구성 실행
- [ ] 권한 및 사용자 계정 확인

### 서비스 검증
- [ ] 데이터 무결성 전면 검사
- [ ] 주요 애플리케이션 기능 테스트
- [ ] 성능 지표 정상 범위 확인
- [ ] 사용자 접근 테스트 수행
- [ ] API 엔드포인트 응답 테스트

## 완료 후 단계
### 상태 확인
- [ ] 전체 시스템 상태 최종 점검
- [ ] 데이터 정합성 100% 확인
- [ ] 성능 지표 지속 모니터링
- [ ] 사용자 피드백 수집 및 모니터링
- [ ] 오류 로그 추가 발생 여부 확인

### 문서화
- [ ] 롤백 실행 로그 정리 및 아카이빙
- [ ] 실패 원인 상세 분석 문서 작성
- [ ] 롤백 과정 타임라인 정리
- [ ] 보고서 생성 및 관련자에게 배포
- [ ] 개선사항 및 교훈 목록 작성

### 후속 조치
- [ ] AWS 리소스 일시 중단 또는 정리
- [ ] 비용 관리 및 예산 재검토
- [ ] 재마이그레이션 계획 수립
- [ ] 팀 회고 미팅 일정 조율
- [ ] 프로세스 개선 방안 도출

## 커뮤니케이션 체크리스트
### 내부 팀
- [ ] 롤백 시작 전체 팀 알림
- [ ] 주요 단계별 진행 상황 실시간 공유
- [ ] 이슈 발생 시 즉시 에스컬레이션
- [ ] 롤백 완료 알림 및 현 상황 전파
- [ ] 다음 단계 및 계획 공지

### 외부 이해관계자
- [ ] 사용자 대상 서비스 상태 공지 (필요시)
- [ ] 경영진 상황 보고 (중요 이슈)
- [ ] 벤더 및 파트너사 알림
- [ ] 고객 지원팀 상황 업데이트
- [ ] SLA 영향도 평가 및 통보

## 위험 관리
### 모니터링 항목
- [ ] CPU 및 메모리 사용률 추이
- [ ] 네트워크 트래픽 패턴
- [ ] 데이터베이스 성능 지표
- [ ] 애플리케이션 응답 시간
- [ ] 에러 발생률 및 패턴
- [ ] 사용자 세션 및 접속 상태

### 비상 계획
- [ ] 추가 롤백 필요시 대응 계획
- [ ] 데이터 복구 실패시 대안책
- [ ] 장시간 복구시 임시 서비스 방안
- [ ] 외부 전문가 지원 요청 절차
- [ ] 미디어 대응 계획 (중대 장애시)

## 검토 및 승인
### 실행 전 최종 확인
- [ ] 롤백 계획서 전체 팀 검토 완료
- [ ] 체크리스트 모든 항목 숙지
- [ ] 롤백 스크립트 문법 및 로직 확인
- [ ] 백업 데이터 최종 검증
- [ ] 비상 연락망 정상 작동 확인

### 승인 절차
- [ ] 기술팀 리더 승인
- [ ] 운영팀 매니저 승인  
- [ ] 상급자 승인 (중요 시스템)
- [ ] 최종 실행 결정 확정
- [ ] 실행 시점 및 담당자 확정

---

## 추가 참고사항

### 롤백 후 주의사항
- 롤백 완료 직후 최소 2시간은 집중 모니터링
- 성능 지표가 평상시 수준으로 복구되는지 확인
- 사용자 불만 또는 이상 동작 신고 모니터링
- 데이터 동기화 이슈 지속 확인

### 재마이그레이션 준비
- 실패 원인 완전 해결 확인
- 롤백 과정에서 발견된 이슈 반영
- 추가 테스트 시나리오 도출
- 더 강화된 모니터링 체계 구축

*이 체크리스트는 롤백 실행 시 필수적으로 확인해야 할 모든 항목을 포함합니다.*
*실제 실행 전 팀 전체가 이 체크리스트를 철저히 검토하시기 바랍니다.*
